{"version":3,"sources":["../src/1.1.1.js"],"names":["context","Syntax","RuleError","report","getSource","helper","desumasuList","dearuList","reportResult","list","desumasu","dearu","forEach","node","matches","message","match","value","line","lineNumber","column","columnIndex","Document","Str","isChildNode","Link","Image","BlockQuote","Emphasis","ListItem","text","retDesumasu","length","push","retDearu","desumasuCount","reduce","count","dearuCount"],"mappings":"AAAA;AACA;AACA;;;;;;;;;;;;;;;;;;;;kBAiBe,UAAUA,OAAV,EAAmB;AAAA;;AAAA,QACzBC,MADyB,GACeD,OADf,CACzBC,MADyB;AAAA,QACjBC,SADiB,GACeF,OADf,CACjBE,SADiB;AAAA,QACNC,MADM,GACeH,OADf,CACNG,MADM;AAAA,QACEC,SADF,GACeJ,OADf,CACEI,SADF;;AAE9B,QAAIC,SAAS,mCAAeL,OAAf,CAAb;AACA,QAAIM,eAAe,EAAnB;AACA,QAAIC,YAAY,EAAhB;;AAEA,aAASC,YAAT,CAAsBC,IAAtB,QAA+C;AAAA,YAAlBC,QAAkB,QAAlBA,QAAkB;AAAA,YAARC,KAAQ,QAARA,KAAQ;;AAC3CF,aAAKG,OAAL,CAAa,iBAAqB;AAAA,gBAAnBC,IAAmB,SAAnBA,IAAmB;AAAA,gBAAbC,OAAa,SAAbA,OAAa;;AAC9BA,oBAAQF,OAAR,CAAgB,iBAAS;AACrB,oBAAIG,gBAAJ;AACA,oBAAIL,QAAJ,EAAc;AACVK,mXAA8EC,MAAMC,KAApF;AACH,iBAFD,MAEO,IAAIN,KAAJ,EAAW;AACdI,yXAA+EC,MAAMC,KAArF;AACH;AACDd,uBAAOU,IAAP,EAAa,IAAIX,SAAJ,CAAca,OAAd,EAAuB;AAChCG,0BAAMF,MAAMG,UAAN,GAAmB,CADO;AAEhCC,4BAAQJ,MAAMK;AAFkB,iBAAvB,CAAb;AAIH,aAXD;AAYH,SAbD;AAcH;;AAGD,8CACKpB,OAAOqB,QADZ,cACuB;AACfhB,uBAAe,EAAf;AACAC,oBAAY,EAAZ;AACH,KAJL,0BAKKN,OAAOsB,GALZ,YAKiBV,IALjB,EAKsB;AACd;AACA;AACA,YAAIR,OAAOmB,WAAP,CAAmBX,IAAnB,EAAyB,CAACZ,OAAOwB,IAAR,EAAcxB,OAAOyB,KAArB,EAA4BzB,OAAO0B,UAAnC,EAA+C1B,OAAO2B,QAAtD,CAAzB,CAAJ,EAA+F;AAC3F;AACH;AACD;AACA,YAAIvB,OAAOmB,WAAP,CAAmBX,IAAnB,EAAyB,CAACZ,OAAO4B,QAAR,CAAzB,CAAJ,EAAiD;AAC7C;AACH;AACD,YAAIC,OAAO1B,UAAUS,IAAV,CAAX;AACA,YAAIkB,cAAc,2CAAgBD,IAAhB,CAAlB;AACA,YAAIC,YAAYC,MAAZ,GAAqB,CAAzB,EAA4B;AACxB1B,yBAAa2B,IAAb,CAAkB;AACdpB,sBAAMA,IADQ;AAEdC,yBAASiB;AAFK,aAAlB;AAIH;AACD,YAAIG,WAAW,wCAAaJ,IAAb,CAAf;AACA,YAAII,SAASF,MAAT,GAAkB,CAAtB,EAAyB;AACrBzB,sBAAU0B,IAAV,CAAe;AACXpB,sBAAMA,IADK;AAEXC,yBAASoB;AAFE,aAAf;AAIH;AACJ,KA9BL,0BA+BQjC,OAAOqB,QA/Bf,iCA+BiC;AACzB,YAAIa,gBAAgB7B,aAAa8B,MAAb,CAAoB,UAACC,KAAD;AAAA,gBAASvB,OAAT,SAASA,OAAT;AAAA,mBAAsBuB,QAAQvB,QAAQkB,MAAtC;AAAA,SAApB,EAAkE,CAAlE,CAApB;AACA,YAAIM,aAAa/B,UAAU6B,MAAV,CAAiB,UAACC,KAAD;AAAA,gBAASvB,OAAT,SAASA,OAAT;AAAA,mBAAsBuB,QAAQvB,QAAQkB,MAAtC;AAAA,SAAjB,EAA+D,CAA/D,CAAjB;AACA,YAAIG,kBAAkB,CAAlB,IAAuBG,eAAe,CAA1C,EAA6C;AACzC;AACH;AACD,YAAIH,gBAAgBG,UAApB,EAAgC;AAC5B9B,yBAAaD,SAAb,EAAwB,EAACI,OAAO,IAAR,EAAxB;AACH,SAFD,MAEO,IAAIwB,gBAAgBG,UAApB,EAAgC;AACnC9B,yBAAaF,YAAb,EAA2B,EAACI,UAAU,IAAX,EAA3B;AACH,SAFM,MAEA;AACHF,yBAAaD,SAAb,EAAwB,EAACI,OAAO,IAAR,EAAxB;AACH;AACJ,KA5CL;AA8CH,C;;AAxED;;AACA","file":"1.1.1.js","sourcesContent":["// LICENSE : MIT\n\"use strict\";\n/*\n1.1.1.本文\n\n本文の文体は、敬体(ですます調)あるいは常体(である調)のどちらかで統一します。\n敬体と常体を混在させないようにします。\n敬体と常体のどちらを使うかは、文書の目的や読み手に応じて決めます。\n\n 敬体(ですます調)\n一般読者向けの紹介文、パンフレット、マニュアル、ウェブサイトの本文では、基本的に「敬体」を使います。\n親しみやすい、柔らかい雰囲気で内容を伝えることができます。\n\n 常体(である調)\n常体は、簡潔に、力強い雰囲気で内容を伝えることができる文体です\n丁寧ではない印象を読み手に与える場合があるため、通常、一般向けのマニュアルの本文では使われません。\n */\nimport {analyzeDesumasu, analyzeDearu} from \"analyze-desumasu-dearu\";\nimport {RuleHelper} from \"textlint-rule-helper\";\nexport default function (context) {\n    let {Syntax, RuleError, report, getSource} = context;\n    let helper = new RuleHelper(context);\n    let desumasuList = [];\n    let dearuList = [];\n\n    function reportResult(list, {desumasu, dearu}) {\n        list.forEach(({node, matches}) => {\n            matches.forEach(match => {\n                let message;\n                if (desumasu) {\n                    message = `本文を常体(である調)に統一して下さい。\\n本文の文体は、敬体(ですます調)あるいは常体(である調)のどちらかで統一します。\\n\"${match.value}\"が敬体(ですます調)です。`\n                } else if (dearu) {\n                    message = `本文を敬体(ですます調)に統一して下さい。\\n本文の文体は、敬体(ですます調)あるいは常体(である調)のどちらかで統一します。\\n\"${match.value}\"が常体(である調)です。`\n                }\n                report(node, new RuleError(message, {\n                    line: match.lineNumber - 1,\n                    column: match.columnIndex\n                }));\n            });\n        });\n    }\n\n\n    return {\n        [Syntax.Document](){\n            desumasuList = [];\n            dearuList = [];\n        },\n        [Syntax.Str](node){\n            // 本文以外は無視する\n            // => isUserWrittenNode\n            if (helper.isChildNode(node, [Syntax.Link, Syntax.Image, Syntax.BlockQuote, Syntax.Emphasis])) {\n                return;\n            }\n            // Listについては1.1.3. 箇条書きで扱う\n            if (helper.isChildNode(node, [Syntax.ListItem])) {\n                return;\n            }\n            let text = getSource(node);\n            let retDesumasu = analyzeDesumasu(text);\n            if (retDesumasu.length > 0) {\n                desumasuList.push({\n                    node: node,\n                    matches: retDesumasu\n                });\n            }\n            let retDearu = analyzeDearu(text);\n            if (retDearu.length > 0) {\n                dearuList.push({\n                    node: node,\n                    matches: retDearu\n                });\n            }\n        },\n        [`${Syntax.Document}:exit`](){\n            let desumasuCount = desumasuList.reduce((count, {matches}) => count + matches.length, 0);\n            let dearuCount = dearuList.reduce((count, {matches}) => count + matches.length, 0);\n            if (desumasuCount === 0 || dearuCount === 0) {\n                return;\n            }\n            if (desumasuCount > dearuCount) {\n                reportResult(dearuList, {dearu: true});\n            } else if (desumasuCount < dearuCount) {\n                reportResult(desumasuList, {desumasu: true});\n            } else {\n                reportResult(dearuList, {dearu: true});\n            }\n        }\n    }\n}"]}